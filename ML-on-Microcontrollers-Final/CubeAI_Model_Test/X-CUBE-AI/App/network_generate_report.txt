Neural Network Tools for STM32AI v1.7.0 (STM.ai v8.0.0-19389)
Created date          : 2023-06-07 19:15:18
Parameters            : generate --name network -m /Users/mnadalorian/MLonMC/ML-on-Microcontrollers/ML-on-Microcontrollers-Final/tflite/model_10_Reduced_J_QAT.tflite --type tflite --compression none --verbosity 1 --workspace /var/folders/qf/1vv5kcws1_bg00x_m1wqgvlh0000gn/T/mxAI_workspace1218289207854229876283168349857127 --output /Users/mnadalorian/.stm32cubemx/network_output --allocate-inputs --series stm32l4 --allocate-outputs

Exec/report summary (generate)
--------------------------------------------------------------------------------------------------------------------------------------------
model file         :   /Users/mnadalorian/MLonMC/ML-on-Microcontrollers/ML-on-Microcontrollers-Final/tflite/model_10_Reduced_J_QAT.tflite   
type               :   tflite                                                                                                               
c_name             :   network                                                                                                              
compression        :   none                                                                                                                 
options            :   allocate-inputs, allocate-outputs                                                                                    
optimization       :   balanced                                                                                                             
target/series      :   stm32l4                                                                                                              
workspace dir      :   /private/var/folders/qf/1vv5kcws1_bg00x_m1wqgvlh0000gn/T/mxAI_workspace1218289207854229876283168349857127            
output dir         :   /Users/mnadalorian/.stm32cubemx/network_output                                                                       
model_fmt          :   ss/sa per-channel                                                                                                    
model_name         :   model_10_Reduced_J_QAT                                                                                               
model_hash         :   e365c8b5b9c8c53c84d2316f22482854                                                                                     
params #           :   25,562 items (25.46 KiB)                                                                                             
--------------------------------------------------------------------------------------------------------------------------------------------
input 1/1          :   'serving_default_conv2d_38_input0' (domain:activations/**default**)                                                  
                   :   3072 items, 3.00 KiB, ai_u8, s=0.00392157, zp=0, (1,32,32,3)                                                         
output 1/1         :   'nl_10_0_conversion' (domain:activations/**default**)                                                                
                   :   10 items, 10 B, ai_u8, s=0.00390625, zp=0, (1,1,1,10)                                                                
macc               :   3,720,168                                                                                                            
weights (ro)       :   26,072 B (25.46 KiB) (1 segment) / -76,176(-74.5%) vs float model                                                    
activations (rw)   :   26,016 B (25.41 KiB) (1 segment) *                                                                                   
ram (total)        :   26,016 B (25.41 KiB) = 26,016 + 0 + 0                                                                                
--------------------------------------------------------------------------------------------------------------------------------------------
(*) 'input'/'output' buffers can be used from the activations buffer

Model name - model_10_Reduced_J_QAT ['serving_default_conv2d_38_input0'] ['nl_10_0_conversion']
------ -------------------------------------------- ---------------------- ------------- ----------- ---------------------------------- --- ----------------- ----------------------- ---------------------------------- 
m_id   layer (type,original)                        oshape                 param/size           macc                       connected to   | c_size            c_macc                  c_type                             
------ -------------------------------------------- ---------------------- ------------- ----------- ---------------------------------- --- ----------------- ----------------------- ---------------------------------- 
0      serving_default_conv2d_38_input0 (Input, )   [b:1,h:32,w:32,c:3]                                                                   |                   +6,144(+100.0%)         converter_oi8[0]                   
       conversion_0 (Conversion, QUANTIZE)          [b:1,h:32,w:32,c:3]                        6,144   serving_default_conv2d_38_input0   |                   -6,144(-100.0%)         
------ -------------------------------------------- ---------------------- ------------- ----------- ---------------------------------- --- ----------------- ----------------------- ---------------------------------- 
1      conv2d_1 (Conv2D, CONV_2D)                   [b:1,h:32,w:32,c:16]   448/496           442,384                       conversion_0   |                                           optimized_conv2d_oi8[1]            
       nl_1_nl (Nonlinearity, CONV_2D)              [b:1,h:32,w:32,c:16]                      16,384                           conv2d_1   |                   -16,384(-100.0%)        
------ -------------------------------------------- ---------------------- ------------- ----------- ---------------------------------- --- ----------------- ----------------------- ---------------------------------- 
2      conv2d_2 (Conv2D, CONV_2D)                   [b:1,h:32,w:32,c:16]   2,320/2,368     2,359,312                            nl_1_nl   | -2,368(-100.0%)   -2,359,312(-100.0%)     pad_oi8[2]                         
       nl_2_nl (Nonlinearity, CONV_2D)              [b:1,h:32,w:32,c:16]                      16,384                           conv2d_2   |                   -16,384(-100.0%)        
------ -------------------------------------------- ---------------------- ------------- ----------- ---------------------------------- --- ----------------- ----------------------- ---------------------------------- 
3      pool_3 (Pool, MAX_POOL_2D)                   [b:1,h:8,w:8,c:16]                        16,384                            nl_2_nl   | +2,368(+100.0%)   +2,359,312(+14400.1%)   optimized_conv2d_oi8[3]            
------ -------------------------------------------- ---------------------- ------------- ----------- ---------------------------------- --- ----------------- ----------------------- ---------------------------------- 
4      conv2d_4 (Conv2D, CONV_2D)                   [b:1,h:8,w:8,c:32]     4,640/4,736       294,944                             pool_3   |                                           pad_oi8/conv2d_oi8[4, 5]           
       nl_4_nl (Nonlinearity, CONV_2D)              [b:1,h:8,w:8,c:32]                         2,048                           conv2d_4   |                   -2,048(-100.0%)         
------ -------------------------------------------- ---------------------- ------------- ----------- ---------------------------------- --- ----------------- ----------------------- ---------------------------------- 
5      conv2d_5 (Conv2D, CONV_2D)                   [b:1,h:8,w:8,c:32]     9,248/9,344       589,856                            nl_4_nl   | -9,344(-100.0%)   -589,856(-100.0%)       pad_oi8[6]                         
       nl_5_nl (Nonlinearity, CONV_2D)              [b:1,h:8,w:8,c:32]                         2,048                           conv2d_5   |                   -2,048(-100.0%)         
------ -------------------------------------------- ---------------------- ------------- ----------- ---------------------------------- --- ----------------- ----------------------- ---------------------------------- 
6      pool_6 (Pool, MAX_POOL_2D)                   [b:1,h:2,w:2,c:32]                         2,048                            nl_5_nl   | +9,344(+100.0%)   +589,856(+28801.6%)     optimized_conv2d_oi8[7]            
------ -------------------------------------------- ---------------------- ------------- ----------- ---------------------------------- --- ----------------- ----------------------- ---------------------------------- 
7      reshape_7 (Reshape, RESHAPE)                 [b:1,c:128]                                                                  pool_6   |                                           
------ -------------------------------------------- ---------------------- ------------- ----------- ---------------------------------- --- ----------------- ----------------------- ---------------------------------- 
8      dense_8 (Dense, FULLY_CONNECTED)             [b:1,c:64]             8,256/8,448         8,256                          reshape_7   |                                           dense_oi8[8]                       
       nl_8_nl (Nonlinearity, FULLY_CONNECTED)      [b:1,c:64]                                    64                            dense_8   |                   -64(-100.0%)            
------ -------------------------------------------- ---------------------- ------------- ----------- ---------------------------------- --- ----------------- ----------------------- ---------------------------------- 
9      dense_9 (Dense, FULLY_CONNECTED)             [b:1,c:10]             650/680               650                            nl_8_nl   |                   +20(+3.1%)              dense_oi8/converter_of32[9, 10]    
------ -------------------------------------------- ---------------------- ------------- ----------- ---------------------------------- --- ----------------- ----------------------- ---------------------------------- 
10     nl_10 (Nonlinearity, SOFTMAX)                [b:1,c:10]                                   150                            dense_9   |                   +20(+13.3%)             nl_of32/converter_ou8[o][11, 12]   
------ -------------------------------------------- ---------------------- ------------- ----------- ---------------------------------- --- ----------------- ----------------------- ---------------------------------- 
11     conversion_11 (Conversion, QUANTIZE)         [b:1,c:10]                                    20                              nl_10   |                   -20(-100.0%)            
------ -------------------------------------------- ---------------------- ------------- ----------- ---------------------------------- --- ----------------- ----------------------- ---------------------------------- 
model/c-model: macc=3,757,076/3,720,168 -36,908(-1.0%) weights=26,072/26,072  activations=--/26,016 io=--/0



Generated C-graph summary
------------------------------------------------------------------------------------------------------------------------
model name            : model_10_reduced_j_qat
c-name                : network
c-node #              : 13
c-array #             : 34
activations size      : 26016 (1 segment)
weights size          : 26072 (1 segment)
macc                  : 3720168
inputs                : ['serving_default_conv2d_38_input0_output']
outputs               : ['nl_10_0_conversion_output']

C-Arrays (34)
------ ----------------------------------------- ------------- ------------------------- --------------- ------------- --------- 
c_id   name (*_array)                            item/size     domain/mem-pool           c-type          fmt           comment   
------ ----------------------------------------- ------------- ------------------------- --------------- ------------- --------- 
0      conv2d_4_output                           2048/2048     activations/**default**   int8_t          sa8                     
1      conv2d_5_pad_before_output                3200/3200     activations/**default**   int8_t          sa8                     
2      conv2d_5_output                           128/128       activations/**default**   int8_t          sa8                     
3      dense_8_output                            64/64         activations/**default**   int8_t          sa8                     
4      dense_9_output                            10/10         activations/**default**   int8_t          sa8                     
5      dense_9_0_conversion_output               10/40         activations/**default**   float           float32                 
6      nl_10_output                              10/40         activations/**default**   float           float32                 
7      nl_10_0_conversion_output                 10/10         activations/**default**   uint8_t         ua8           /output   
8      conv2d_1_weights                          432/432       weights/weights           const int8_t    ss8/ch(16)              
9      conv2d_1_bias                             16/64         weights/weights           const int32_t   ss32/ch(16)             
10     conv2d_2_weights                          2304/2304     weights/weights           const int8_t    ss8/ch(16)              
11     conv2d_2_bias                             16/64         weights/weights           const int32_t   ss32/ch(16)             
12     conv2d_4_weights                          4608/4608     weights/weights           const int8_t    ss8/ch(32)              
13     conv2d_4_bias                             32/128        weights/weights           const int32_t   ss32/ch(32)             
14     conv2d_5_weights                          9216/9216     weights/weights           const int8_t    ss8/ch(32)              
15     conv2d_5_bias                             32/128        weights/weights           const int32_t   ss32/ch(32)             
16     dense_8_weights                           8192/8192     weights/weights           const int8_t    ss8                     
17     dense_8_bias                              64/256        weights/weights           const int32_t   ss32                    
18     dense_9_weights                           640/640       weights/weights           const int8_t    ss8                     
19     dense_9_bias                              10/40         weights/weights           const int32_t   ss32                    
20     conv2d_1_scratch0                         1196/1196     activations/**default**   int8_t          s8                      
21     conv2d_2_scratch0                         5344/5344     activations/**default**   int8_t          s8                      
22     conv2d_2_scratch1                         2048/2048     activations/**default**   int8_t          sa8                     
23     conv2d_4_scratch0                         6016/6016     activations/**default**   int8_t          s8                      
24     conv2d_5_scratch0                         6592/6592     activations/**default**   int8_t          s8                      
25     conv2d_5_scratch1                         1024/1024     activations/**default**   int8_t          sa8                     
26     dense_8_scratch0                          128/256       activations/**default**   int16_t         s16                     
27     dense_9_scratch0                          64/128        activations/**default**   int16_t         s16                     
28     serving_default_conv2d_38_input0_output   3072/3072     activations/**default**   uint8_t         ua8           /input    
29     conversion_0_output                       3072/3073     activations/**default**   int8_t          sa8                     
30     conv2d_1_output                           16384/16384   activations/**default**   int8_t          sa8                     
31     conv2d_2_pad_before_output                18496/18496   activations/**default**   int8_t          sa8                     
32     conv2d_2_output                           1024/1024     activations/**default**   int8_t          sa8                     
33     conv2d_4_pad_before_output                1600/1600     activations/**default**   int8_t          sa8                     
------ ----------------------------------------- ------------- ------------------------- --------------- ------------- --------- 

C-Layers (13)
------ ---------------------- ---- ------------------- --------- ------ -------------------------------------------- ------------------- 
c_id   name (*_layer)         id   layer_type          macc      rom    tensors                                      shape (array id)    
------ ---------------------- ---- ------------------- --------- ------ -------------------------------------------- ------------------- 
0      conversion_0           0    converter           6144      0      I: serving_default_conv2d_38_input0_output   (1,32,32,3) (28)    
                                                                        O: conversion_0_output                       (1,32,32,3) (29)    
------ ---------------------- ---- ------------------- --------- ------ -------------------------------------------- ------------------- 
1      conv2d_1               1    optimized_conv2d    442384    496    I: conversion_0_output                       (1,32,32,3) (29)    
                                                                        S: conv2d_1_scratch0                                             
                                                                        W: conv2d_1_weights                          (3,16,3,3) (8)      
                                                                        W: conv2d_1_bias                             (1,1,1,16) (9)      
                                                                        O: conv2d_1_output                           (1,32,32,16) (30)   
------ ---------------------- ---- ------------------- --------- ------ -------------------------------------------- ------------------- 
2      conv2d_2_pad_before    2    pad                 0         0      I: conv2d_1_output                           (1,32,32,16) (30)   
                                                                        O: conv2d_2_pad_before_output                (1,34,34,16) (31)   
------ ---------------------- ---- ------------------- --------- ------ -------------------------------------------- ------------------- 
3      conv2d_2               3    optimized_conv2d    2375696   2368   I: conv2d_2_pad_before_output                (1,34,34,16) (31)   
                                                                        S: conv2d_2_scratch0                                             
                                                                        S: conv2d_2_scratch1                                             
                                                                        W: conv2d_2_weights                          (16,16,3,3) (10)    
                                                                        W: conv2d_2_bias                             (1,1,1,16) (11)     
                                                                        O: conv2d_2_output                           (1,8,8,16) (32)     
------ ---------------------- ---- ------------------- --------- ------ -------------------------------------------- ------------------- 
4      conv2d_4_pad_before    4    pad                 0         0      I: conv2d_2_output                           (1,8,8,16) (32)     
                                                                        O: conv2d_4_pad_before_output                (1,10,10,16) (33)   
------ ---------------------- ---- ------------------- --------- ------ -------------------------------------------- ------------------- 
5      conv2d_4               4    conv2d              294944    4736   I: conv2d_4_pad_before_output                (1,10,10,16) (33)   
                                                                        S: conv2d_4_scratch0                                             
                                                                        W: conv2d_4_weights                          (16,32,3,3) (12)    
                                                                        W: conv2d_4_bias                             (1,1,1,32) (13)     
                                                                        O: conv2d_4_output                           (1,8,8,32) (0)      
------ ---------------------- ---- ------------------- --------- ------ -------------------------------------------- ------------------- 
6      conv2d_5_pad_before    5    pad                 0         0      I: conv2d_4_output                           (1,8,8,32) (0)      
                                                                        O: conv2d_5_pad_before_output                (1,10,10,32) (1)    
------ ---------------------- ---- ------------------- --------- ------ -------------------------------------------- ------------------- 
7      conv2d_5               6    optimized_conv2d    591904    9344   I: conv2d_5_pad_before_output                (1,10,10,32) (1)    
                                                                        S: conv2d_5_scratch0                                             
                                                                        S: conv2d_5_scratch1                                             
                                                                        W: conv2d_5_weights                          (32,32,3,3) (14)    
                                                                        W: conv2d_5_bias                             (1,1,1,32) (15)     
                                                                        O: conv2d_5_output                           (1,2,2,32) (2)      
------ ---------------------- ---- ------------------- --------- ------ -------------------------------------------- ------------------- 
8      dense_8                8    dense               8256      8448   I: conv2d_5_output0                          (1,1,1,128) (2)     
                                                                        S: dense_8_scratch0                                              
                                                                        W: dense_8_weights                           (128,1,1,64) (16)   
                                                                        W: dense_8_bias                              (1,1,1,64) (17)     
                                                                        O: dense_8_output                            (1,1,1,64) (3)      
------ ---------------------- ---- ------------------- --------- ------ -------------------------------------------- ------------------- 
9      dense_9                9    dense               650       680    I: dense_8_output                            (1,1,1,64) (3)      
                                                                        S: dense_9_scratch0                                              
                                                                        W: dense_9_weights                           (64,1,1,10) (18)    
                                                                        W: dense_9_bias                              (1,1,1,10) (19)     
                                                                        O: dense_9_output                            (1,1,1,10) (4)      
------ ---------------------- ---- ------------------- --------- ------ -------------------------------------------- ------------------- 
10     dense_9_0_conversion   9    converter           20        0      I: dense_9_output                            (1,1,1,10) (4)      
                                                                        O: dense_9_0_conversion_output               (1,1,1,10) (5)      
------ ---------------------- ---- ------------------- --------- ------ -------------------------------------------- ------------------- 
11     nl_10                  10   nl                  150       0      I: dense_9_0_conversion_output               (1,1,1,10) (5)      
                                                                        O: nl_10_output                              (1,1,1,10) (6)      
------ ---------------------- ---- ------------------- --------- ------ -------------------------------------------- ------------------- 
12     nl_10_0_conversion     10   converter           20        0      I: nl_10_output                              (1,1,1,10) (6)      
                                                                        O: nl_10_0_conversion_output                 (1,1,1,10) (7)      
------ ---------------------- ---- ------------------- --------- ------ -------------------------------------------- ------------------- 



Number of operations per c-layer
------- ------ ---------------------------------- ----------- ------------- -------- ---------- 
c_id    m_id   name (type)                                #op          type   #param   sparsity 
------- ------ ---------------------------------- ----------- ------------- -------- ---------- 
0       0      conversion_0 (converter)                 6,144    smul_u8_s8          
1       1      conv2d_1 (optimized_conv2d)            442,384    smul_s8_s8      448     0.0067 
2       2      conv2d_2_pad_before (pad)                    0    smul_s8_s8          
3       3      conv2d_2 (optimized_conv2d)          2,375,696    smul_s8_s8    2,320     0.0095 
4       4      conv2d_4_pad_before (pad)                    0    smul_s8_s8          
5       4      conv2d_4 (conv2d)                      294,944    smul_s8_s8    4,640     0.0147 
6       5      conv2d_5_pad_before (pad)                    0    smul_s8_s8          
7       6      conv2d_5 (optimized_conv2d)            591,904    smul_s8_s8    9,248     0.0096 
8       8      dense_8 (dense)                          8,256    smul_s8_s8    8,256     0.0117 
9       9      dense_9 (dense)                            650    smul_s8_s8      650     0.0062 
10      9      dense_9_0_conversion (converter)            20   smul_s8_f32          
11      10     nl_10 (nl)                                 150    op_f32_f32          
12      10     nl_10_0_conversion (converter)              20   smul_f32_u8          
------- ------ ---------------------------------- ----------- ------------- -------- ---------- 
total                                               3,720,168                 25,562     0.0111 

Number of operation types
---------------- ----------- ----------- 
operation type             #           % 
---------------- ----------- ----------- 
smul_u8_s8             6,144        0.2% 
smul_s8_s8         3,713,834       99.8% 
smul_s8_f32               20        0.0% 
op_f32_f32               150        0.0% 
smul_f32_u8               20        0.0% 

Complexity report (model)
------ ---------------------------------- ------------------------- ------------------------- ---------- 
m_id   name                               c_macc                    c_rom                     c_id       
------ ---------------------------------- ------------------------- ------------------------- ---------- 
0      serving_default_conv2d_38_input0   |                  0.2%   |                  0.0%   [0]        
1      conv2d_1                           |||               11.9%   |                  1.9%   [1]        
2      conv2d_2                           |                  0.0%   |                  0.0%   [2]        
3      pool_3                             ||||||||||||||||  63.9%   ||||               9.1%   [3]        
4      conv2d_4                           ||                 7.9%   ||||||||          18.2%   [4, 5]     
5      conv2d_5                           |                  0.0%   |                  0.0%   [6]        
6      pool_6                             ||||              15.9%   ||||||||||||||||  35.8%   [7]        
8      dense_8                            |                  0.2%   ||||||||||||||    32.4%   [8]        
9      dense_9                            |                  0.0%   ||                 2.6%   [9, 10]    
10     nl_10                              |                  0.0%   |                  0.0%   [11, 12]   
------ ---------------------------------- ------------------------- ------------------------- ---------- 
macc=3,720,168 weights=26,072 act=26,016 ram_io=0

Generated files (7)
---------------------------------------------------------------------- 
/Users/mnadalorian/.stm32cubemx/network_output/network_config.h        
/Users/mnadalorian/.stm32cubemx/network_output/network.h               
/Users/mnadalorian/.stm32cubemx/network_output/network.c               
/Users/mnadalorian/.stm32cubemx/network_output/network_data_params.h   
/Users/mnadalorian/.stm32cubemx/network_output/network_data_params.c   
/Users/mnadalorian/.stm32cubemx/network_output/network_data.h          
/Users/mnadalorian/.stm32cubemx/network_output/network_data.c          
